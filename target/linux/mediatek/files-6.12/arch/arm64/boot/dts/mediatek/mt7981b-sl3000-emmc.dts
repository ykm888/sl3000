/dts-v1/;

/* ===== dt-bindings ===== */
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/linux-event-codes.h>
#include <dt-bindings/leds/common.h>
#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/pinctrl/mt65xx.h>

/* ===== SoC 基础层 ===== */
#include "mt7981b.dtsi"

/ {
	model = "SL-3000 eMMC Board (Ultimate Edition)";
	compatible = "sl,sl3000-emmc", "mediatek,mt7981";

	/* ===========================
	 * 内存（1GB）
	 * =========================== */
	memory@40000000 {
		device_type = "memory";
		reg = <0 0x40000000 0 0x40000000>;
	};

	/* ===========================
	 * 电源（WiFi / eMMC / SPI NOR）
	 * =========================== */
	reg_3p3v: regulator-3p3v {
		compatible = "regulator-fixed";
		regulator-name = "fixed-3.3v";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		regulator-always-on;
		regulator-boot-on;
	};

	reg_1p8v: regulator-1p8v {
		compatible = "regulator-fixed";
		regulator-name = "fixed-1.8v";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-always-on;
		regulator-boot-on;
		vin-supply = <&reg_3p3v>;
	};

	/* ===========================
	 * CPU OPP 表
	 * =========================== */
	cpu_opp_table: cpu-opp-table {
		compatible = "operating-points-v2";

		opp-400000000 {
			opp-hz = /bits/ 64 <400000000>;
			opp-microvolt = <750000>;
			clock-latency-ns = <100000>;
		};

		opp-650000000 {
			opp-hz = /bits/ 64 <650000000>;
			opp-microvolt = <800000>;
			clock-latency-ns = <100000>;
		};

		opp-850000000 {
			opp-hz = /bits/ 64 <850000000>;
			opp-microvolt = <850000>;
			clock-latency-ns = <100000>;
		};

		opp-1000000000 {
			opp-hz = /bits/ 64 <1000000000>;
			opp-microvolt = <900000>;
			clock-latency-ns = <100000>;
		};

		opp-1100000000 {
			opp-hz = /bits/ 64 <1100000000>;
			opp-microvolt = <950000>;
			clock-latency-ns = <100000>;
		};
	};

	/* ===========================
	 * LED（带触发器）
	 * =========================== */
	leds {
		compatible = "gpio-leds";

		led_status_green: status_green {
			function = LED_FUNCTION_STATUS;
			color = <LED_COLOR_ID_GREEN>;
			gpios = <&pio 9 GPIO_ACTIVE_LOW>;
			linux,default-trigger = "heartbeat";
		};

		led_status_red: status_red {
			function = LED_FUNCTION_FAULT;
			color = <LED_COLOR_ID_RED>;
			gpios = <&pio 8 GPIO_ACTIVE_LOW>;
			linux,default-trigger = "panic";
		};

		led_status_blue: status_blue {
			function = LED_FUNCTION_WLAN;
			color = <LED_COLOR_ID_BLUE>;
			gpios = <&pio 7 GPIO_ACTIVE_LOW>;
			linux,default-trigger = "phy0tpt";
		};
	};

	/* ===========================
	 * 按键
	 * =========================== */
	keys {
		compatible = "gpio-keys";

		reset {
			label = "reset";
			gpios = <&pio 1 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_RESTART>;
			debounce-interval = <10>;
		};

		wps {
			label = "wps";
			gpios = <&pio 0 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_WPS_BUTTON>;
			debounce-interval = <10>;
		};
	};

	/* ===========================
	 * GPIO 导出
	 * =========================== */
	gpio-export {
		compatible = "gpio-export";
		#size-cells = <0>;

		gpio_debug_2 {
			gpio-export,name = "gpio2-debug";
			gpio-export,output = <0>;
			gpios = <&pio 2 GPIO_ACTIVE_LOW>;
		};

		gpio_debug_3 {
			gpio-export,name = "gpio3-debug";
			gpio-export,output = <0>;
			gpios = <&pio 3 GPIO_ACTIVE_LOW>;
		};
	};

	/* ===========================
	 * 别名
	 * =========================== */
	aliases {
		serial0 = &{/soc/serial@11002000};
		label-mac-device = &gmac0;

		led-boot = &led_status_green;
		led-failsafe = &led_status_red;
		led-running = &led_status_green;
		led-upgrade = &led_status_blue;
	};

	/* ===========================
	 * chosen
	 * =========================== */
	chosen {
		stdout-path = "serial0:115200n8";
		bootargs = "console=ttyS0,115200 earlycon root=/dev/mmcblk0p5 rootwait rw";
	};
}; /* ←←← 这就是你之前缺失的根节点收尾 */